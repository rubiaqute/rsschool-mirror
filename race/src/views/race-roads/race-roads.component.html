<nav class="navigation-buttons">
  <button
    class="button button_main"
    [disabled]="raceMode"
    (click)="winnersPage = false"
  >
    Garage
  </button>
  <button
    class="button button_main"
    [disabled]="raceMode"
    (click)="winnersPage = true; this.allCarsBacktoStart()"
  >
    Winners
  </button>
</nav>
<app-winners
    *ngIf="winnersPage"
    [state]="winnerPageState"
    (byPageChange)="changeWinnersPage($event)"
    (bySortChange)="changeWinnersSort($event)"
  ></app-winners>



  <div *ngIf="!winnersPage">
    <div class="navigation-buttons">
      <app-car-customization
        class="customization-block"
        (byAddingCars)="makeCar($event)"
        (byUpdatingCar)="updateCar($event)"
        (byCustomizationInput)="updateCustomizationInputs($event)"
        [carForUpdate]="selectedId"
        [isAvailable]="raceMode"
        [customizationObject]="customizationInputs"
      ></app-car-customization>

      <div class="race_buttons">
        <p class="info info__small" *ngIf="abortionFlag">
          Waiting for race abortion...
        </p>
        <div class="navigation-buttons">
          <button
            class="button button_main"
            (click)="renderCars()"
            [disabled]="raceMode"
          >
            Get {{ CARS_TO_RENDER }}
            <mat-icon
              aria-hidden="false"
              style="font-size: 2.4rem; width: 3rem; height: 3rem"
              >directions_car_filled</mat-icon
            >
          </button>
          <button
            class="button button_main"
            (click)="resetRace()"
            [disabled]="abortionFlag || pending"
          >
            <mat-icon
              aria-hidden="false"
              style="font-size: 3.4rem; width: 4rem; height: 4rem"
              >block</mat-icon
            >
          </button>
          <button
            class="button button_main"
            (click)="startRace()"
            [disabled]="raceMode || abortionFlag"
          >
            <mat-icon
              aria-hidden="false"
              style="font-size: 3.4rem; width: 4rem; height: 4rem"
              >flag</mat-icon
            >
          </button>
        </div>
      </div>
    </div>
    <p class="info info__big">Total amount of cars: {{ totalAmountOfCars }}</p>
    <p class="info info__small">Page: {{ pageNumber }}</p>
    <div class="cars" *ngFor="let car of carsArray">
      <div class="cars__data">
        <button
          class="button button_adds button_colored"
          (click)="move(car.id)"
          [disabled]="isMoving(car.id) || raceMode || abortionFlag"
        >
          A
        </button>
        <button
          class="button button_adds"
          (click)="stop(car.id)"
          [disabled]="!isMoving(car.id) || raceMode"
        >
          B
        </button>
        <button
          class="button button_adds button_colored"
          (click)="changeCar(car.id)"
          [disabled]="isMoving(car.id) || raceMode"
        >
          <mat-icon
            aria-hidden="false"
            aria-label="Example home icon"
            style="font-size: 1.4rem"
            >build</mat-icon
          >
        </button>
        <button
          class="button button_adds"
          (click)="deleteCar(car.id)"
          [disabled]="isMoving(car.id) || raceMode"
        >
          &#10008;
        </button>
        <p class="info info__small">{{ car.name }}</p>
      </div>

      <app-car
        class="cars__car-image"
        [class.selected]="isSelected(car.id)"
        id="car-{{ car.id }}"
        [color]="car.color"
      ></app-car>
      <app-flag class="flag" id="flag-{{ car.id }}"></app-flag>
    </div>
    <div class="navigation-buttons navigation-buttons_margined">
      <button
        class="button button_main"
        (click)="previousPage()"
        [disabled]="pageNumber < 2 || raceMode"
      >
        &larr;
      </button>
      <button
        class="button button_main"
        (click)="nextPage()"
        [disabled]="pageNumber > pageAmount - 1 || raceMode"
      >
        &rarr;
      </button>
    </div>
  </div>

<ng-container *ngIf="showResultMessage">
  <div class="overlay">
    <div class="modal">
      <p class="winner-message" *ngIf="winner.name">
        And wins...
        <span class="winner-message__name">{{ winner.name }}</span> with the
        result {{ winner.time }}s
      </p>
      <p class="winner-message" *ngIf="!winner.name">
        Sorry, no winner in this race... All participants are broken.
      </p>
      <button
        class="button button_main button_main_message"
        (click)="closeResultMessage()"
      >
        Close
      </button>
    </div>
  </div>
</ng-container>

