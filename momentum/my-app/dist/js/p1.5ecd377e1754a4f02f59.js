(()=>{"use strict";let e=[["Настройки","Settings","Los ajustes"],["Погода","Weather","Estado del tiempo"],["Цитаты","Quotes","Las Citas"],["Время","Time","El tiempo"],["Дата","Date","La fecha"],["Музыка","Music","La musica"],["Приветствие","Greeting","La salutacion"],["КОВИД-19","COVID-19","COVID-19"],["Язык","Languge","La lengua"],["Русский","Russian","Ruso"],["Английский","English","Ingles"],["Испанский","Spanish","Espanol"],["Источник изображений","Images source","El origen de imagines"],["Тэг изображений","Images tag","El tag de imagines"]],t=[["Статистика КОВИД-19 для:","COVID-19 stats for:","COVID-19 estadísticas para:"],["Страна","Country","El pais"],["Соединенное Королевство","United Kingdom","El Reino Unido"],["Россия","Russia","Rusia"],["Испания","Spain","Espana"],["Новые случаи","New confirmed","Confirmados nuevos"],["Всего подтверждено","Total confirmed","Confirmados total"],["Новые смерти","New deaths","Muertos nuevos"],["Всего смертей","Total deaths","Muertos total"]],o=[["Доброго утречка","Good morning","Buenos dias"],["Добрый день","Good afternoon","Buenas tardes"],["Добрый вечер","Good evening","Buenas noches"],["Доброй ночи","Good night","Buenas noches"]],n=[["Скорость ветра","Wind speed","La velocidad del viento"],["м/с","m/s","m/s"],["Влажность","Humidity","La humedad"],["Ошибка! Не найден город","Error! city not found for","Error! La ciudad no encontrada"]];const a=document.querySelector(".play-list"),s=[{title:"Aqua Caelestis",src:"./assets/sounds/Aqua Caelestis.mp3",duration:"00:39"},{title:"River Flows In You",src:"./assets/sounds/River Flows In You.mp3",duration:"01:37"},{title:"Ennio Morricone",src:"./assets/sounds/Ennio Morricone.mp3",duration:"01:37"},{title:"Summer Wind",src:"./assets/sounds/Summer Wind.mp3",duration:"01:50"}];s.forEach((e=>{const t=document.createElement("li"),o=document.createElement("span");t.classList.add("track"),a.append(t),t.textContent=e.title,t.appendChild(o),o.classList.add("small-play")}));const r=s,c=document.querySelectorAll(".track");c[0].classList.add("current-track");const l=document.querySelector(".time"),u=document.querySelector(".date"),i=document.querySelector(".greeting"),d=document.querySelector(".name"),m=document.querySelector("body");let g=Math.floor(19*Math.random()+1);const h=document.querySelector(".slide-next"),v=document.querySelector(".slide-prev"),S=document.querySelector(".city"),y=document.querySelector(".quote"),p=document.querySelector(".author"),f=document.querySelector(".change-quote"),L=new Audio;let q,w=1,E=0,C="en-US",$="lang=en",I="Wrong tag!";const x=document.querySelector(".input-tag");let k=!1,M=0;L.src=r[M].src,document.querySelector(".song-name").textContent=r[M].title,document.querySelector(".time-audio .length").textContent=r[M].duration;const j=document.querySelector(".play"),b=document.querySelector(".play-next"),A=document.querySelector(".play-prev"),D=document.querySelector(".progress-volume"),T=document.querySelector(".volume-button"),N=document.querySelector(".progress-play"),R=document.querySelectorAll(".small-play");L.volume=D.value/100;let U=[[".weather","true"],[".quote-container","true"],[".time","true"],[".date","true"],[".player","true"],[".greeting-container","true"],[".extra-tools","true"]],W="./js/quotesEN.json";function G(){const e=(new Date).toLocaleDateString(`${C}`,{weekday:"long",month:"long",day:"numeric"});u.textContent=e}function V(){const e=`${function(){const e=(new Date).getHours();return e>5&&e<12?`${o[0][w]}`:e>11&&e<18?`${o[1][w]}`:e>17&&e<24?`${o[2][w]}`:e>0&&e<6||0==e?`${o[3][w]}`:void 0}()}`;i.textContent=e}function Y(){for(let e=0;e<U.length;e++)"true"==U[e][1]?(ee[e].classList.add("switch-on"),document.querySelector(`${U[e][0]}`).classList.remove("hidden")):(ee[e].classList.remove("switch-on"),document.querySelector(`${U[e][0]}`).classList.add("hidden"));console.log(U)}function B(){0==E&&function(){const e=(g+1).toString().padStart(2,"0"),t=H(),o=new Image,n=`url('https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/${t}/${e}.jpg')`;o.src=`https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/${t}/${e}.jpg`,o.onload=()=>{m.style.backgroundImage=n}}(),1==E&&async function(){null==q&&(q=H());const e=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=6b0e62b31d36361714f3a06d8297328d&tags=${q}&extras=url_l&format=json&nojsoncallback=1`,t=await fetch(e),o=await t.json(),n=Math.floor(Math.random()*o.photos.photo.length);if(0==o.photos.photo.length)return document.querySelector(".error").textContent=`${I}`,void setTimeout((()=>{document.querySelector(".error").textContent=""}),2e3);const a=await o.photos.photo[n].url_l;console.log(a);const s=new Image;s.src=`${a}`,s.onload=()=>{m.style.backgroundImage=`url('${s.src}')`}}(),2==E&&async function(){null==q&&(q=H());const e=`https://api.unsplash.com/photos/random?query=${q}&client_id=-LHVbAfsjEtQYmM1CEAmYotn-NEMWw2YpUls9nUaeuA`,t=await fetch(e),o=await t.json();if(null==o.urls)return document.querySelector(".error").textContent=`${I}`,void setTimeout((()=>{document.querySelector(".error").textContent=""}),2e3);const n=await o.urls.regular,a=new Image;a.src=`${n}`,console.log(a.src),a.onload=()=>{m.style.backgroundImage=`url('${a.src}')`}}(),console.log(q)}function H(){const e=(new Date).getHours();return e>5&&e<12?"morning":e>11&&e<18?"afternoon":e>17&&e<24?"evening":e>0&&e<6||0==e?"night":void 0}async function O(){const e=document.querySelector(".weather-icon"),t=document.querySelector(".temperature"),o=document.querySelector(".wind"),a=document.querySelector(".humidity"),s=document.querySelector(".weather-description"),r=document.querySelector(".weather-error");try{const c=`https://api.openweathermap.org/data/2.5/weather?q=${S.value}&${$}&appid=e57257892292e552c0054a48a736b278&units=metric`,l=await fetch(c),u=await l.json();r.textContent="",e.className="weather-icon owf",e.classList.add(`owf-${u.weather[0].id}`),t.textContent=`${Math.round(u.main.temp)}°C`,s.textContent=u.weather[0].description,o.textContent=`${n[0][w]}: ${Math.round(u.wind.speed)} ${n[1][w]}`,a.textContent=`${n[2][w]}: ${Math.round(u.main.humidity)}%`}catch(c){r.textContent=`${n[3][w]} '${S.value}'!`,e.className="weather-icon owf",t.textContent="",s.textContent="",o.textContent="",a.textContent=""}}async function _(){const e=W,t=await fetch(e),o=await t.json(),n=Math.floor(Math.random()*o.quotes.length);y.textContent=o.quotes[n].quote,p.textContent=o.quotes[n].author}function F(){k?(L.pause(),k=!1):(console.log(L.src),L.play(),k=!0)}function Q(e){e!=M?(R[M].classList.remove("paused"),c[M].classList.remove("current-track"),M=e,c[M].classList.add("current-track"),L.src=r[M].src,document.querySelector(".song-name").textContent=r[M].title,R[M].classList.add("paused"),j.classList.add("pause"),k=!1,F()):(R[M].classList.toggle("paused"),j.classList.toggle("pause"),F())}function K(){c[M].classList.remove("current-track"),R[M].classList.remove("paused"),M=(M+1+r.length)%r.length,c[M].classList.add("current-track"),L.src=r[M].src,document.querySelector(".song-name").textContent=r[M].title,k&&(k=!1,R[M].classList.add("paused"),F())}function X(){0==D.value?T.classList.add("mute"):T.classList.remove("mute"),D.value,L.volume=D.value/100}function z(e){const t=e.offsetX/N.offsetWidth*L.duration;L.currentTime=t}function J(e){let t=parseInt(e),o=parseInt(t/60);t-=60*o;const n=parseInt(o/60);return o-=60*n,0===n?`${o}:${String(t%60).padStart(2,0)}`:`${String(n).padStart(2,0)}:${o}:${String(t%60).padStart(2,0)}`}x.addEventListener("change",(e=>{x.value&&(q=x.value,B())})),B(),function e(){const t=(new Date).toLocaleTimeString();l.textContent=t,setTimeout(e,1e3),G(),V()}(),h.addEventListener("click",(function(){g=(g+1+20)%20,B()})),v.addEventListener("click",(function(){g=(g-1+20)%20,B()})),S.addEventListener("change",O),window.addEventListener("load",_),f.addEventListener("click",_),window.addEventListener("beforeunload",(function(){localStorage.setItem("name",d.value),localStorage.setItem("city",S.value);for(let e=0;e<U.length;e++)localStorage.setItem(`visibility${e}`,U[e][1]);localStorage.setItem("language",w),localStorage.setItem("imgSource",E),localStorage.setItem("inputtag",q)})),window.addEventListener("load",(function(){for(let e=0;e<U.length;e++)localStorage.getItem(`visibility${e}`)&&(U[e][1]=localStorage.getItem(`visibility${e}`)),Y();console.log(U),localStorage.getItem("name")&&(d.value=localStorage.getItem("name")),localStorage.getItem("city")?(S.value=localStorage.getItem("city"),O()):(0==w&&(S.value="Минск"),1==w&&(S.value="Minsk"),2==w&&(S.value="Minsk"),O()),localStorage.getItem("language")&&(oe[w].classList.remove("active"),w=localStorage.getItem("language"),se(w)),localStorage.getItem("inputtag")&&(q=localStorage.getItem("inputtag")),localStorage.getItem("imgSource")&&(ne[E].classList.remove("active"),E=localStorage.getItem("imgSource"),ae(E))})),j.addEventListener("click",(function(){j.classList.toggle("pause"),R[M].classList.toggle("paused"),F()})),b.addEventListener("click",K),A.addEventListener("click",(function(){c[M].classList.remove("current-track"),R[M].classList.remove("paused"),M=(M-1+r.length)%r.length,c[M].classList.add("current-track"),L.src=r[M].src,document.querySelector(".song-name").textContent=r[M].title,k&&(k=!1,R[M].classList.add("paused"),F())})),L.addEventListener("ended",K),D.addEventListener("change",X),D.addEventListener("mousemove",X),T.addEventListener("click",(function(){0==D.value?D.value=40:D.value=0,X()}));let P=!1;N.addEventListener("click",z),N.addEventListener("mousemove",(e=>P&&z(e))),N.addEventListener("mousedown",(()=>P=!0)),N.addEventListener("mouseup",(()=>P=!1)),L.addEventListener("timeupdate",(function(){const e=Math.ceil(L.currentTime/L.duration*100);document.querySelector(".time-audio .current").textContent=J(L.currentTime),N.value=e||0}));for(let e=0;e<R.length;e++)R[e].addEventListener("click",(t=>Q(e)));L.addEventListener("loadeddata",(()=>{document.querySelector(".time-audio .length").textContent=J(L.duration)}),!1);const Z=document.querySelector(".settings");document.querySelector(".settings-icon").addEventListener("click",(function(){Z.classList.toggle("active")}));const ee=document.querySelectorAll(".switch-btn");for(let e=0;e<ee.length;e++)ee[e].addEventListener("click",(t=>te(e)));function te(e){ee[e].classList.toggle("switch-on");let t=document.querySelector(`${U[e][0]}`);"true"==U[e][1]?U[e][1]="false":U[e][1]="true",t.classList.toggle("hidden"),console.log(U)}document.addEventListener("mousedown",(function(e){null===e.target.closest(".settings")&&"settings-icon"!=e.target.classList&&Z.classList.remove("active")}));const oe=document.querySelectorAll(".language");for(let e=0;e<oe.length;e++)oe[e].addEventListener("click",(t=>se(e)));const ne=document.querySelectorAll(".img-source");for(let e=0;e<ne.length;e++)ne[e].addEventListener("click",(t=>ae(e)));function ae(e){ne[E].classList.remove("active"),E=e,ne[E].classList.add("active"),B()}function se(o){oe[w].classList.remove("active"),w=o,oe[w].classList.add("active"),0==w&&(W="./js/quotesRU.json"),1==w&&(W="./js/quotesEN.json"),2==w&&(W="./js/quotesES.json"),_(),0==w&&(C="ru-RU"),1==w&&(C="en-US"),2==w&&(C="es-ES"),G(),0==w&&($="lang=ru"),1==w&&($="lang=en"),2==w&&($="lang=es"),localStorage.getItem("city")?(S.value=localStorage.getItem("city"),O()):(0==w&&(S.value="Минск"),1==w&&(S.value="Minsk"),2==w&&(S.value="Minsk"),O()),V(),function(){0==w&&(I="Неверный тэг!"),1==w&&(I="Wrong tag!"),2==w&&(I="El tag incorrecto!");const t=document.querySelectorAll(".translate-item");for(let o=0;o<t.length;o++)t[o].textContent=e[o][w]}(),function(){const e=document.querySelectorAll(".covid-translation");ie.value=w;for(let o=0;o<e.length;o++)e[o].textContent=t[o][w];de()}(),function(){const e=document.querySelector(".name");0==w&&(e.placeholder="Имя"),1==w&&(e.placeholder="Name"),2==w&&(e.placeholder="Nombre")}()}const re=document.querySelector(".new-confirmed"),ce=document.querySelector(".total-confirmed"),le=document.querySelector(".new-deaths"),ue=document.querySelector(".total-deaths"),ie=document.querySelector(".country-select");async function de(){let e;1==ie.value&&(e=182),0==ie.value&&(e=142),2==ie.value&&(e=162);try{const t="https://api.covid19api.com/summary",o=await fetch(t),n=await o.json();re.textContent=n.Countries[e].NewConfirmed,ce.textContent=n.Countries[e].TotalConfirmed,le.textContent=n.Countries[e].NewDeaths,ue.textContent=n.Countries[e].TotalDeaths}catch(e){console.log("Error")}}ie.addEventListener("change",de),de()})();